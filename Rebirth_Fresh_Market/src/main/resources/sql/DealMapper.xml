<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
		PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
		
<mapper namespace="DealMapper">

	<resultMap id="DealSelectMap" type="deal">
		<result property="itemNo" column="item_no" jdbcType="INTEGER"/>
		<result property="registerUserNo" column="" jdbcType="INTEGER"/>
		<result property="contactUserNo" column="" jdbcType="INTEGER"/>
		<result property="registerUserName" column="" jdbcType="VARCHAR"/>
		<result property="contactUserName" column="" jdbcType="VARCHAR"/>
		<result property="dealDate" column="date" jdbcType="DATE"/>
		<result property="time" column="time" jdbcType="TIME"/>
		<result property="location.gridX" column="grid_x" jdbcType="DOUBLE"/>
		<result property="location.gridY" column="grid_y" jdbcType="DOUBLE"/>
	</resultMap>
	
	<insert id="makeDeal" parameterType="deal">
		INSERT deal(user_no,
					date,
					time,
					grid_x,
					grid_y)
		VALUES(#{userNo},
			   #{dealDate},
			   #{time},
			   #{location.gridX},
			   #{location.gridY}	)
	</insert>
	
	<select id="findDeal">
		SELECT ???????
		FROM
		WHERE 
	</select>
	
	<update id="updateDeal">
		UPDATE deal
		<set>
			<if test=""></if>
		</set>
	</update>
	
	<delete id="completeDeal">
		{call
		declare
		begin
			DELETE FROM deal WHERE item_no=#{itemNo}
			DELETE FROM location WHERE item_no=#{itemNo}
			DELETE FROM item_pic WHERE item_no=#{itemNo}
			DELETE FROM reply WHERE item_no=#{itemNo}
			DELETE FROM item WHERE item_no=#{itemNo}
		end
		}		
	</delete>
	
	<update id="cancelDeal">
		UPDATE
	</update>
	
	<select id="findDealList" parameterType="search">
		SELECT ?????
		FROM deal d, (SELECT
					  l.grid_x1,l.grid_y1
					  FROM item i,location l
					  WHERE i.item_no=l.item_no	),
		WHERE 
	</select>
</mapper>